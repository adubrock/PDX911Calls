<script src="//maps.google.com/maps/api/js?v=3.13&sensor=false&libraries=geometry" type="text/javascript"></script>

<div style='width: 100%;'>
  <div id="map-canvas"/>
</div>

<script type="text/javascript">
var markerAttributes = <%= raw @markers.to_json %>;
google.maps.event.addDomListener(window, 'load', function initialize() {
  var map = new google.maps.Map(document.getElementById("map-canvas"));
  bounds = new google.maps.LatLngBounds();

  markers = markerAttributes.map(function(attributes) {
    var myLatlng = new google.maps.LatLng(attributes.lat, attributes.lng);
    bounds.extend(myLatlng);

    var marker = new google.maps.Marker({
      position: myLatlng,
      map: map,
      title: attributes.title
    });

    var infowindow = new google.maps.InfoWindow({
      content: attributes.infoWindow
    });

    google.maps.event.addListener(marker, 'click', function() {
      infowindow.open(map,marker);
    });
  })
  map.fitBounds(bounds);
});
</script>

